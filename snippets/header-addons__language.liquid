{% comment %}
	Render addons language switcher in header
	Arguments:
	- classes_btn: extra class css btn
	- classes_dropdown: extra class css for dropdown menu
{% endcomment %}
{%- liquid
	unless form_id
		assign form_id = 'language-form'
	endunless
	assign min = 65
	assign max = 80
	assign diff = max | minus: min
	assign random_number = "now" | date: "%N" | modulo: diff | plus: min
	assign language_active = ""
-%}

<div class="gsp-header-addons-item gsp-header-addons-item__language dropdown">
	{% assign form_id = 'localization_form-' | append: random_number %}
	<gsp-dropdown data-submit="true" data-form-id="{{ form_id }}">
		{% form 'localization', data-localization-form: '', id: form_id %}
			<select name="locale_code" class="d-none dropdown-select" data-localization-select>
				{%- for language in localization.available_languages -%}
					{%- liquid
						if language.iso_code == localization.language.iso_code
							assign language_active = language.endonym_name
						endif
					-%}
					<option
						value="{{- language.iso_code -}}"
						{% if language.iso_code == localization.language.iso_code %}
							selected="selected"
						{%- endif -%}
					>
						{{- language.endonym_name -}}
					</option>
				{%- endfor -%}
			</select>
			<button class="gsp-header-addons-dropdown btn btn-link dropdown-toggle {{ classes_btn }}"
					type="button" data-bs-toggle="dropdown"
					aria-expanded="false">{{ language_active }}
				<span class="arrown-dropdown ms-2 lh-1">{% render 'icons', icon: 'angle-down-sharp-regular' %}</span>
			</button>
			<div class="dropdown-menu py-0 {{ classes_dropdown }}">
				{%- for language in localization.available_languages -%}
					<a class="dropdown-item text-heading text-uppercase fw-heading py-2 {% if language.iso_code == localization.language.iso_code %}active{% endif %}"
					   href="#"
					   data-value="{{ language.iso_code }}">{{ language.endonym_name }}</a>
				{% endfor %}
			</div>
		{% endform %}
	</gsp-dropdown>
</div>

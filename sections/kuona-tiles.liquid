{% comment %}
  KUONA – Tiles (3'lü görsel grid + buton)
{% endcomment %}

<section class="ku-tiles" style="--pad: {{ section.settings.vpad }}px;">
  <div class="ku-tiles__wrap {% if section.settings.full_width %}page-width--full{% else %}page-width{% endif %}">
    {% if section.settings.heading != blank %}
      <div class="ku-tiles__head">
        <h2 class="ku-tiles__h">{{ section.settings.heading }}</h2>
        {% if section.settings.subheading != blank %}
          <p class="ku-tiles__sub">{{ section.settings.subheading }}</p>
        {% endif %}
      </div>
    {% endif %}

    <div class="ku-tiles__grid">
      {% for block in section.blocks %}
        {% assign img = block.settings.image %}
        {% assign href = block.settings.link | default: '#' %}
        <div class="ku-tiles__item" {{ block.shopify_attributes }}>
          <a class="ku-tiles__imglink"
             href="{{ href }}"
             {% if block.settings.new_tab %}target="_blank" rel="noopener"{% endif %}>
            {% if img %}
              <img
                src="{{ img | image_url: width: 1600 }}"
                alt="{{ block.settings.button_label | escape }}"
                loading="lazy"
                class="ku-tiles__img">
            {% else %}
              <div class="ku-tiles__ph">Upload image</div>
            {% endif %}
          </a>

          {% if block.settings.button_label != blank %}
            <a class="ku-tiles__btn"
               href="{{ href }}"
               {% if block.settings.new_tab %}target="_blank" rel="noopener"{% endif %}>
              {{ block.settings.button_label }}
              <span class="ku-tiles__arrow">→</span>
            </a>
          {% endif %}
        </div>
      {% endfor %}
    </div>
  </div>
</section>

<style>
  .ku-tiles{ padding: var(--pad) 0; }
  .ku-tiles__wrap{ max-width: 1280px; margin: 0 auto; padding: 0 16px; }
  .ku-tiles__head{ text-align:center; margin-bottom: 28px; }
  .ku-tiles__h{ font-size: 24px; letter-spacing: .08em; text-transform: uppercase; }
  .ku-tiles__sub{ opacity:.8; margin-top:6px; }

  /* ==== GRID – sadece 3 sütun ==== */
  .ku-tiles__grid {
    display: grid;
    gap: 28px;
    grid-template-columns: repeat(3, 1fr);
  }

  @media (max-width: 1100px){
    .ku-tiles__grid{ grid-template-columns: repeat(2, 1fr); }
  }
  @media (max-width: 640px){
    .ku-tiles__grid{ grid-template-columns: 1fr; }
  }

  .ku-tiles__item{ display:flex; flex-direction:column; align-items:center; }
  .ku-tiles__imglink{ display:block; width:100%; border-radius:6px; overflow:hidden; }
  .ku-tiles__img{
    display:block;
    width:100%;
    height: clamp(260px, 34vw, 460px);
    object-fit: cover;
    transition: transform .35s ease, filter .35s ease;
  }
  .ku-tiles__imglink:hover .ku-tiles__img{
    transform: scale(1.02); filter: brightness(0.96);
  }

  .ku-tiles__btn{
    margin-top: 18px; display:inline-flex; align-items:center; gap:10px;
    border:1px solid #111; padding: 14px 22px; border-radius: 2px;
    text-decoration:none; color:#111; letter-spacing:.06em; font-size: 14px;
    transition: background .2s ease, color .2s ease, opacity .2s ease;
  }
  .ku-tiles__btn:hover{ background:#111; color:#fff; }
  .ku-tiles__arrow{ transform: translateY(-1px); }

  .ku-tiles__ph{
    height: clamp(260px, 34vw, 460px); background:#f2f2f2; color:#999;
    display:flex; align-items:center; justify-content:center;
    font-size:12px; letter-spacing:.08em; text-transform:uppercase;
  }
</style>

{% schema %}
{
  "name": "Kuona – Tiles (3-up)",
  "settings": [
    { "type": "text", "id": "heading", "label": "Heading", "default": "Explore Kuona" },
    { "type": "text", "id": "subheading", "label": "Subheading", "default": "Book, shop or join" },
    { "type": "checkbox", "id": "full_width", "label": "Full width container", "default": false },
    { "type": "range", "id": "vpad", "label": "Vertical padding (px)", "min": 0, "max": 120, "step": 4, "default": 40 }
  ],
  "blocks": [
    {
      "type": "tile",
      "name": "Tile",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Image" },
        { "type": "text", "id": "button_label", "label": "Button label", "default": "BOOK EYE EXAM" },
        { "type": "url", "id": "link", "label": "Link" },
        { "type": "checkbox", "id": "new_tab", "label": "Open in new tab", "default": true }
      ]
    }
  ],
  "max_blocks": 3,
  "presets": [
    {
      "name": "Kuona – Tiles (3-up)",
      "blocks": [
        {
          "type": "tile",
          "settings": {
            "button_label": "BOOK EYE EXAM",
            "link": "https://web.opticalpos.com/site/!appt_req?sid=C20F6510A39824FEB2320D43F821D9B0",
            "new_tab": true
          }
        },
        { "type": "tile", "settings": { "button_label": "BOOK STYLING CONSULTATION", "link": "/pages/styling-consultation" } },
        { "type": "tile", "settings": { "button_label": "MEMBERSHIPS", "link": "/pages/memberships" } }
      ]
    }
  ]
}
{% endschema %}

{% liquid
	capture class_container
		render 'classes-container', container: section.settings.container
	endcapture
	assign class_container = class_container | strip_newlines
	assign bg_color = section.settings.bg_color
	assign text_color = section.settings.text_color
	assign fs_content = section.settings.fs_content
	assign pd_top = section.settings.padding_top
	assign pd_bottom = section.settings.padding_bottom
%}
{%- if section.settings.show_announcement -%}
	{%- if section.settings.homepage_only == false or request.page_type == 'index' -%}
		<section
			class="gsp-section-{{ section.id }} gsp-announcement-bar position-relative {%- if section.settings.text_uppercase %} text-uppercase {%- endif %} {%- if section.settings.show_divider %} border-bottom {%- endif %} {{ section.settings.custom_class }}"
			role="region" aria-label="Announcement Bar">
			<div class="{{ class_container }}">
				{%- if section.settings.text != blank -%}
					{%- if section.settings.link != blank -%}
						<a href="{{ section.settings.link }}" class="announcement-bar-link text-reset">
					{%- endif -%}
					<div class="announcement-bar-message text-{{ section.settings.text_alignment }}">
						{{ section.settings.text | escape }}
						{%- if section.settings.link != blank -%}
							{% render 'icons', icon: 'arrow-right-long' %}
						{%- endif -%}
					</div>
					{%- if section.settings.link != blank -%}
						</a>
					{%- endif -%}
				{%- endif -%}
				{% if section.settings.show_close %}
					<div
						class="gsp-announcement-bar-close position-absolute top-0 bottom-0 end-0 my-auto me-3 h-1em d-flex link">
						{% render 'icons', icon: 'close' %}
					</div>
					<script>
						document.querySelector('.gsp-announcement-bar-close').addEventListener('click', function () {
							document.querySelector('.gsp-announcement-bar').closest('.shopify-section').remove();
						})
					</script>
				{% endif %}
			</div>
		</section>
	{%- endif -%}
{%- endif -%}
{% style %}
	.gsp-section-{{ section.id }} {
	{%- if bg_color != blank and bg_color != "rgba(0,0,0,0)" %}
		--gsp-announcement-bg: {{ bg_color }};
	{% endif -%}
	{%- if text_color != blank and text_color != "rgba(0,0,0,0)" %}
		--gsp-announcement-color: {{ text_color }};
	{% endif -%}
	{%- if fs_content != blank and fs_content != -1 %}
		--gsp-announcement-fs: {{ fs_content }}px;
	{% endif -%}

	{%- if pd_top != blank and pd_top != -1 %}
		--gsp-announcement-pdt: {{ pd_top }}px;
	{% endif -%}
	{%- if pd_bottom != blank and pd_bottom != -1 %}
		--gsp-announcement-pdb: {{ pd_bottom }}px;
	{% endif -%}
	}
{% endstyle %}
{% schema %}
{
    "name": "t:sections.announcement_bar.name",
    "settings": [
        {
            "type": "header",
            "content": "t:sections.announcement_bar.settings.header__content_announcement"
        },
        {
            "type": "text",
            "id": "text",
            "default": "Welcome to our store",
            "label": "t:sections.announcement_bar.settings.text.label"
        },
        {
            "type": "url",
            "id": "link",
            "label": "t:sections.announcement_bar.settings.link.label"
        },
        {
            "type": "header",
            "content": "t:sections.announcement_bar.settings.header__announcement_settings"
        },
        {
            "type": "checkbox",
            "id": "show_announcement",
            "label": "t:sections.announcement_bar.settings.show_announcement.label",
            "default": true
        },
        {
            "type": "checkbox",
            "id": "homepage_only",
            "label": "t:sections.announcement_bar.settings.homepage_only.label",
            "default": false
        },
        {
            "type": "checkbox",
            "id": "show_close",
            "label": "t:sections.announcement_bar.settings.show_close.label",
            "default": true
        },
        {
            "type": "checkbox",
            "id": "show_divider",
            "label": "t:sections.announcement_bar.settings.show_divider.label",
            "default": false
        },
        {
            "type": "checkbox",
            "id": "text_uppercase",
            "label": "t:sections.announcement_bar.settings.text_uppercase.label",
            "default": false
        },
        {
            "type": "header",
            "content": "t:sections.announcement_bar.settings.header__announcement_style"
        },
        {
            "type": "range",
            "id": "fs_content",
            "label": "t:sections.announcement_bar.settings.fs_content.label",
            "info": "t:sections.announcement_bar.settings.fs_content.info",
            "min": -1,
            "max": 99,
            "step": 1,
            "default": -1
        },
        {
            "type": "color",
            "id": "bg_color",
            "label": "t:sections.announcement_bar.settings.bg_color.label"
        },
        {
            "type": "color",
            "id": "text_color",
            "label": "t:sections.announcement_bar.settings.text_color.label"
        },
        {
            "type": "select",
            "id": "text_alignment",
            "options": [
                {
                    "value": "start",
                    "label": "t:sections.announcement_bar.settings.text_alignment.options__start"
                },
                {
                    "value": "center",
                    "label": "t:sections.announcement_bar.settings.text_alignment.options__center"
                },
                {
                    "value": "end",
                    "label": "t:sections.announcement_bar.settings.text_alignment.options__end"
                }
            ],
            "default": "center",
            "label": "t:sections.announcement_bar.settings.text_alignment.label"
        },
        {
            "type": "header",
            "content": "General configuration"
        },
        {
            "type": "number",
            "id": "padding_top",
            "label": "Padding top",
            "info": "Set value -1 to apply default settings from theme.",
            "default": -1
        },
        {
            "type": "number",
            "id": "padding_bottom",
            "label": "Padding bottom",
            "info": "Set value -1 to apply default settings from theme.",
            "default": -1
        },
        {
            "type": "select",
            "id": "container",
            "label": "t:general.container.label",
            "default": "inherit",
            "options": [
                {
                    "value": "inherit",
                    "label": "t:general.container.options__inherit"
                },
                {
                    "value": "container",
                    "label": "t:general.container.options__container"
                },
                {
                    "value": "container-xl",
                    "label": "t:general.container.options__container_xl"
                },
                {
                    "value": "container-xxl",
                    "label": "t:general.container.options__container_xxl"
                },
                {
                    "value": "container-fluid",
                    "label": "t:general.container.options__container_fluid"
                },
                {
                    "value": "container-fluid-no-pd",
                    "label": "t:general.container.options__container_fluid_no_pd"
                }
            ]
        },
        {
            "type": "text",
            "id": "custom_class",
            "label": "Extended classes section"
        }
    ]
}
{% endschema %}